#include "platform.h"
#include "emu.h"

#define INSN_MAP_ENTRY(insn) [RV_INSN__##insn] = #insn
#define SYSC_MAP_ENTRY(sysc) [RV_SYSCALL__##sysc] = #sysc
#define INSN_MAP_ENTRY_S(insn, repr) [RV_INSN__##insn] = repr
#define SYSC_MAP_ENTRY_S(insn, repr) [RV_SYSCALL__##sysc] = repr

const char* const repr_insn_map[] = {
  INSN_MAP_ENTRY(INVALID),
  INSN_MAP_ENTRY(LUI),
  INSN_MAP_ENTRY(AUIPC),
  INSN_MAP_ENTRY(JAL),
  INSN_MAP_ENTRY(JALR),
  INSN_MAP_ENTRY(BEQ),
  INSN_MAP_ENTRY(BNE),
  INSN_MAP_ENTRY(BLT),
  INSN_MAP_ENTRY(BGE),
  INSN_MAP_ENTRY(BLTU),
  INSN_MAP_ENTRY(BGEU),
  INSN_MAP_ENTRY(LB),
  INSN_MAP_ENTRY(LH),
  INSN_MAP_ENTRY(LW),
  INSN_MAP_ENTRY(LBU),
  INSN_MAP_ENTRY(LHU),
  INSN_MAP_ENTRY(SB),
  INSN_MAP_ENTRY(SH),
  INSN_MAP_ENTRY(SW),
  INSN_MAP_ENTRY(ADDI),
  INSN_MAP_ENTRY(SLTI),
  INSN_MAP_ENTRY(SLTIU),
  INSN_MAP_ENTRY(XORI),
  INSN_MAP_ENTRY(ORI),
  INSN_MAP_ENTRY(ANDI),
  INSN_MAP_ENTRY(SLLI),
  INSN_MAP_ENTRY(SRLI),
  INSN_MAP_ENTRY(SRAI),
  INSN_MAP_ENTRY(ADD),
  INSN_MAP_ENTRY(SUB),
  INSN_MAP_ENTRY(SLL),
  INSN_MAP_ENTRY(SLT),
  INSN_MAP_ENTRY(SLTU),
  INSN_MAP_ENTRY(XOR),
  INSN_MAP_ENTRY(SRL),
  INSN_MAP_ENTRY(SRA),
  INSN_MAP_ENTRY(OR),
  INSN_MAP_ENTRY(AND),
  INSN_MAP_ENTRY(FENCE),
  INSN_MAP_ENTRY(FENCE_I),
  INSN_MAP_ENTRY(ECALL),
  INSN_MAP_ENTRY(EBREAK),
  INSN_MAP_ENTRY(CSRRW),
  INSN_MAP_ENTRY(CSRRS),
  INSN_MAP_ENTRY(CSRRC),
  INSN_MAP_ENTRY(CSRRWI),
  INSN_MAP_ENTRY(CSRRSI),
  INSN_MAP_ENTRY(CSRRCI),
#if RV32_HAS(EXT_M)
  INSN_MAP_ENTRY(MUL),
  INSN_MAP_ENTRY(MULH),
  INSN_MAP_ENTRY(MULHSU),
  INSN_MAP_ENTRY(MULHU),
  INSN_MAP_ENTRY(DIV),
  INSN_MAP_ENTRY(DIVU),
  INSN_MAP_ENTRY(REM),
  INSN_MAP_ENTRY(REMU),
#endif
#if RV32_HAS(EXT_FD)
  INSN_MAP_ENTRY_S(FLx, "fl.x"),
  INSN_MAP_ENTRY_S(FSx, "fs.x"),
  INSN_MAP_ENTRY_S(FMADDx, "fmadd.x"),
  INSN_MAP_ENTRY_S(FMSUBx, "fmsub.x"),
  INSN_MAP_ENTRY_S(FNMADDx, "fnmadd.x"),
  INSN_MAP_ENTRY_S(FNMSUBx, "fnmsub.x"),
  INSN_MAP_ENTRY_S(FADDx, "fadd.x"),
  INSN_MAP_ENTRY_S(FSUBx, "fsub.x"),
  INSN_MAP_ENTRY_S(FMULx, "fmul.x"),
  INSN_MAP_ENTRY_S(FDIVx, "fdiv.x"),
  INSN_MAP_ENTRY_S(FSQRTx, "fsqrt.x"),
  INSN_MAP_ENTRY_S(FSGNJx, "fsgnj.x"),
  INSN_MAP_ENTRY_S(FSGNJNx, "fsgnjn.x"),
  INSN_MAP_ENTRY_S(FSGNJXx, "fsgnjx.x"),
  INSN_MAP_ENTRY_S(FMINx, "fmin.x"),
  INSN_MAP_ENTRY_S(FMAXx, "fmax.x"),
  INSN_MAP_ENTRY_S(FEQx, "feq.x"),
  INSN_MAP_ENTRY_S(FLTx, "flt.x"),
  INSN_MAP_ENTRY_S(FLEx, "fle.x"),
  INSN_MAP_ENTRY_S(FCLASSx, "fclass.x"),
#endif
#if RV32_HAS(EXT_C)
  INSN_MAP_ENTRY_S(C_NOP, "c.nop"),
  INSN_MAP_ENTRY_S(C_ADDI, "c.addi"),
  INSN_MAP_ENTRY_S(C_JAL, "c.jal"),
  INSN_MAP_ENTRY_S(C_LI, "c.li"),
  INSN_MAP_ENTRY_S(C_ADDI16SP, "c.addi16sp"),
  INSN_MAP_ENTRY_S(C_LUI, "c.lui"),
  INSN_MAP_ENTRY_S(C_SRLI, "c.srli"),
  INSN_MAP_ENTRY_S(C_SRAI, "c.srai"),
  INSN_MAP_ENTRY_S(C_ANDI, "c.andi"),
  INSN_MAP_ENTRY_S(C_SUB, "c.sub"),
  INSN_MAP_ENTRY_S(C_XOR, "c.xor"),
  INSN_MAP_ENTRY_S(C_OR, "c.or"),
  INSN_MAP_ENTRY_S(C_AND, "c.and"),
  INSN_MAP_ENTRY_S(C_J, "c.j"),
  INSN_MAP_ENTRY_S(C_BEQZ, "c.beqz"),
  INSN_MAP_ENTRY_S(C_BNEZ, "c.bnez"),
  INSN_MAP_ENTRY_S(C_ADDI4SPN, "c.addi4spn"),
  INSN_MAP_ENTRY_S(C_FLD, "c.fld"),
  INSN_MAP_ENTRY_S(C_LW, "c.lw"),
  INSN_MAP_ENTRY_S(C_FLW, "c.flw"),
  INSN_MAP_ENTRY_S(C_FSD, "c.fsd"),
  INSN_MAP_ENTRY_S(C_SW, "c.sw"),
  INSN_MAP_ENTRY_S(C_FSW, "c.fsw"),
  INSN_MAP_ENTRY_S(C_SLLI, "c.slli"),
  INSN_MAP_ENTRY_S(C_SLLI64, "c.slli64"),
  INSN_MAP_ENTRY_S(C_FLDSP, "c.fldsp"),
  INSN_MAP_ENTRY_S(C_LWSP, "c.lwsp"),
  INSN_MAP_ENTRY_S(C_FLWSP, "c.flwsp"),
  INSN_MAP_ENTRY_S(C_JR, "c.jr"),
  INSN_MAP_ENTRY_S(C_MV, "c.mv"),
  INSN_MAP_ENTRY_S(C_EBREAK, "c.ebreak"),
  INSN_MAP_ENTRY_S(C_JALR, "c.jalr"),
  INSN_MAP_ENTRY_S(C_ADD, "c.add"),
  INSN_MAP_ENTRY_S(C_FSDSP, "c.fsdsp"),
  INSN_MAP_ENTRY_S(C_SWSP, "c.swsp"),
  INSN_MAP_ENTRY_S(C_FSWSP, "c.fswsp"),
#endif
};

const char* const repr_reg_abi_map[] = {
  "zero",
  "ra",
  "sp",
  "gp",
  "tp",
  "t0",
  "t1",
  "t2",
  "s0",
  "s1",
  "a0",
  "a1",
  "a2",
  "a3",
  "a4",
  "a5",
  "a6",
  "a7",
  "s2",
  "s3",
  "s4",
  "s5",
  "s6",
  "s7",
  "s8",
  "s9",
  "s10",
  "s11",
  "t3",
  "t4",
  "t5",
  "t6"
};

const char* const repr_syscall_map[] = {
  SYSC_MAP_ENTRY(IO_SETUP),
  SYSC_MAP_ENTRY(IO_DESTROY),
  SYSC_MAP_ENTRY(IO_SUBMIT),
  SYSC_MAP_ENTRY(IO_CANCEL),
  SYSC_MAP_ENTRY(IO_GETEVENTS),
  SYSC_MAP_ENTRY(SETXATTR),
  SYSC_MAP_ENTRY(LSETXATTR),
  SYSC_MAP_ENTRY(FSETXATTR),
  SYSC_MAP_ENTRY(GETXATTR),
  SYSC_MAP_ENTRY(LGETXATTR),
  SYSC_MAP_ENTRY(FGETXATTR),
  SYSC_MAP_ENTRY(LISTXATTR),
  SYSC_MAP_ENTRY(LLISTXATTR),
  SYSC_MAP_ENTRY(FLISTXATTR),
  SYSC_MAP_ENTRY(REMOVEXATTR),
  SYSC_MAP_ENTRY(LREMOVEXATTR),
  SYSC_MAP_ENTRY(FREMOVEXATTR),
  SYSC_MAP_ENTRY(GETCWD),
  SYSC_MAP_ENTRY(LOOKUP_DCOOKIE),
  SYSC_MAP_ENTRY(EVENTFD2),
  SYSC_MAP_ENTRY(EPOLL_CREATE1),
  SYSC_MAP_ENTRY(EPOLL_CTL),
  SYSC_MAP_ENTRY(EPOLL_PWAIT),
  SYSC_MAP_ENTRY(DUP),
  SYSC_MAP_ENTRY(DUP3),
  SYSC_MAP_ENTRY(FCNTL64),
  SYSC_MAP_ENTRY(INOTIFY_INIT1),
  SYSC_MAP_ENTRY(INOTIFY_ADD_WATCH),
  SYSC_MAP_ENTRY(IOCTL),
  SYSC_MAP_ENTRY(IOPRIO_SET),
  SYSC_MAP_ENTRY(IOPRIO_GET),
  SYSC_MAP_ENTRY(FLOCK),
  SYSC_MAP_ENTRY(MKNODAT),
  SYSC_MAP_ENTRY(MKDIRAT),
  SYSC_MAP_ENTRY(UNLINKAT),
  SYSC_MAP_ENTRY(SYMLINKAT),
  SYSC_MAP_ENTRY(LINKAT),
  SYSC_MAP_ENTRY(RENAMEAT),
  SYSC_MAP_ENTRY(UMOUNT),
  SYSC_MAP_ENTRY(MOUNT),
  SYSC_MAP_ENTRY(PIVOT_ROOT),
  SYSC_MAP_ENTRY(NI_SYSCALL),
  SYSC_MAP_ENTRY(STATFS64),
  SYSC_MAP_ENTRY(FSTATFS64),
  SYSC_MAP_ENTRY(TRUNCATE64),
  SYSC_MAP_ENTRY(FTRUNCATE64),
  SYSC_MAP_ENTRY(FALLOCATE),
  SYSC_MAP_ENTRY(FACCESSAT),
  SYSC_MAP_ENTRY(CHDIR),
  SYSC_MAP_ENTRY(FCHDIR),
  SYSC_MAP_ENTRY(CHROOT),
  SYSC_MAP_ENTRY(FCHMOD),
  SYSC_MAP_ENTRY(FCHMODAT),
  SYSC_MAP_ENTRY(FCHOWNAT),
  SYSC_MAP_ENTRY(FCHOWN),
  SYSC_MAP_ENTRY(OPENAT),
  SYSC_MAP_ENTRY(CLOSE),
  SYSC_MAP_ENTRY(VHANGUP),
  SYSC_MAP_ENTRY(PIPE2),
  SYSC_MAP_ENTRY(QUOTACTL),
  SYSC_MAP_ENTRY(GETDENTS64),
  SYSC_MAP_ENTRY(LSEEK),
  SYSC_MAP_ENTRY(READ),
  SYSC_MAP_ENTRY(WRITE),
  SYSC_MAP_ENTRY(READV),
  SYSC_MAP_ENTRY(WRITEV),
  SYSC_MAP_ENTRY(PREAD64),
  SYSC_MAP_ENTRY(PWRITE64),
  SYSC_MAP_ENTRY(PREADV),
  SYSC_MAP_ENTRY(PWRITEV),
  SYSC_MAP_ENTRY(SENDFILE64),
  SYSC_MAP_ENTRY(PSELECT6_TIME32),
  SYSC_MAP_ENTRY(PPOLL_TIME32),
  SYSC_MAP_ENTRY(SIGNALFD4),
  SYSC_MAP_ENTRY(VMSPLICE),
  SYSC_MAP_ENTRY(SPLICE),
  SYSC_MAP_ENTRY(TEE),
  SYSC_MAP_ENTRY(READLINKAT),
  SYSC_MAP_ENTRY(NEWFSTATAT),
  SYSC_MAP_ENTRY(NEWFSTAT),
  SYSC_MAP_ENTRY(SYNC),
  SYSC_MAP_ENTRY(FSYNC),
  SYSC_MAP_ENTRY(FDATASYNC),
  SYSC_MAP_ENTRY(SYNC_FILE_RANGE2),
  SYSC_MAP_ENTRY(SYNC_FILE_RANGE),
  SYSC_MAP_ENTRY(TIMERFD_CREATE),
  SYSC_MAP_ENTRY(TIMERFD_SETTIME),
  SYSC_MAP_ENTRY(TIMERFD_GETTIME),
  SYSC_MAP_ENTRY(UTIMENSAT),
  SYSC_MAP_ENTRY(ACCT),
  SYSC_MAP_ENTRY(CAPGET),
  SYSC_MAP_ENTRY(CAPSET),
  SYSC_MAP_ENTRY(PERSONALITY),
  SYSC_MAP_ENTRY(EXIT),
  SYSC_MAP_ENTRY(EXIT_GROUP),
  SYSC_MAP_ENTRY(WAITID),
  SYSC_MAP_ENTRY(SET_TID_ADDRESS),
  SYSC_MAP_ENTRY(UNSHARE),
  SYSC_MAP_ENTRY(FUTEX),
  SYSC_MAP_ENTRY(SET_ROBUST_LIST),
  SYSC_MAP_ENTRY(GET_ROBUST_LIST),
  SYSC_MAP_ENTRY(NANOSLEEP),
  SYSC_MAP_ENTRY(GETITIMER),
  SYSC_MAP_ENTRY(SETITIMER),
  SYSC_MAP_ENTRY(KEXEC_LOAD),
  SYSC_MAP_ENTRY(INIT_MODULE),
  SYSC_MAP_ENTRY(DELETE_MODULE),
  SYSC_MAP_ENTRY(TIMER_CREATE),
  SYSC_MAP_ENTRY(TIMER_GETTIME),
  SYSC_MAP_ENTRY(TIMER_GETOVERRUN),
  SYSC_MAP_ENTRY(TIMER_SETTIME),
  SYSC_MAP_ENTRY(TIMER_DELETE),
  SYSC_MAP_ENTRY(CLOCK_SETTIME),
  SYSC_MAP_ENTRY(CLOCK_GETTIME),
  SYSC_MAP_ENTRY(CLOCK_GETRES),
  SYSC_MAP_ENTRY(CLOCK_NANOSLEEP),
  SYSC_MAP_ENTRY(SYSLOG),
  SYSC_MAP_ENTRY(PTRACE),
  SYSC_MAP_ENTRY(SCHED_SETPARAM),
  SYSC_MAP_ENTRY(SCHED_SETSCHEDULER),
  SYSC_MAP_ENTRY(SCHED_GETSCHEDULER),
  SYSC_MAP_ENTRY(SCHED_GETPARAM),
  SYSC_MAP_ENTRY(SCHED_SETAFFINITY),
  SYSC_MAP_ENTRY(SCHED_GETAFFINITY),
  SYSC_MAP_ENTRY(SCHED_YIELD),
  SYSC_MAP_ENTRY(SCHED_GET_PRIORITY_MAX),
  SYSC_MAP_ENTRY(SCHED_GET_PRIORITY_MIN),
  SYSC_MAP_ENTRY(SCHED_RR_GET_INTERVAL),
  SYSC_MAP_ENTRY(RESTART_SYSCALL),
  SYSC_MAP_ENTRY(KILL)
};

#undef INSN_MAP_ENTRY
#undef SYSC_MAP_ENTRY
#undef INSN_MAP_ENTRY_S
#undef SYSC_MAP_ENTRY_S