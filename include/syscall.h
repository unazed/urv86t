#pragma once

#include "emu.h"

#define RVSYSC_DEFN(name, ...) \
  iword_t name (rvstate_t state,##__VA_ARGS__)

RVSYSC_DEFN(rvsysc_read, iword_t fd, void* buff, word_t count);
RVSYSC_DEFN(rvsysc_write, iword_t fd, void* buff, word_t count);
RVSYSC_DEFN(rvsysc_exit, iword_t code);
RVSYSC_DEFN(rvsysc_fstat, iword_t fd, void* buff);
RVSYSC_DEFN(rvsysc_brk, word_t brk);

extern const char* const repr_syscall_map[];
enum e_syscall
{
  /* https://jborza.com/post/2021-05-11-riscv-linux-syscalls */
  RV_SYSCALL__IO_SETUP = 0,
  RV_SYSCALL__IO_DESTROY = 1,
  RV_SYSCALL__IO_SUBMIT = 2,
  RV_SYSCALL__IO_CANCEL = 3,
  RV_SYSCALL__IO_GETEVENTS = 4,
  RV_SYSCALL__SETXATTR = 5,
  RV_SYSCALL__LSETXATTR = 6,
  RV_SYSCALL__FSETXATTR = 7,
  RV_SYSCALL__GETXATTR = 8,
  RV_SYSCALL__LGETXATTR = 9,
  RV_SYSCALL__FGETXATTR = 10,
  RV_SYSCALL__LISTXATTR = 11,
  RV_SYSCALL__LLISTXATTR = 12,
  RV_SYSCALL__FLISTXATTR = 13,
  RV_SYSCALL__REMOVEXATTR = 14,
  RV_SYSCALL__LREMOVEXATTR = 15,
  RV_SYSCALL__FREMOVEXATTR = 16,
  RV_SYSCALL__GETCWD = 17,
  RV_SYSCALL__LOOKUP_DCOOKIE = 18,
  RV_SYSCALL__EVENTFD2 = 19,
  RV_SYSCALL__EPOLL_CREATE1 = 20,
  RV_SYSCALL__EPOLL_CTL = 21,
  RV_SYSCALL__EPOLL_PWAIT = 22,
  RV_SYSCALL__DUP = 23,
  RV_SYSCALL__DUP3 = 24,
  RV_SYSCALL__FCNTL = 25,
  RV_SYSCALL__INOTIFY_INIT1 = 26,
  RV_SYSCALL__INOTIFY_ADD_WATCH = 27,
  RV_SYSCALL__INOTIFY_RM_WATCH = 28,
  RV_SYSCALL__IOCTL = 29,
  RV_SYSCALL__IOPRIO_SET = 30,
  RV_SYSCALL__IOPRIO_GET = 31,
  RV_SYSCALL__FLOCK = 32,
  RV_SYSCALL__MKNODAT = 33,
  RV_SYSCALL__MKDIRAT = 34,
  RV_SYSCALL__UNLINKAT = 35,
  RV_SYSCALL__SYMLINKAT = 36,
  RV_SYSCALL__LINKAT = 37,
  RV_SYSCALL__RENAMEAT = 38,
  RV_SYSCALL__UMOUNT2 = 39,
  RV_SYSCALL__MOUNT = 40,
  RV_SYSCALL__PIVOT_ROOT = 41,
  RV_SYSCALL__NFSSERVCTL = 42,
  RV_SYSCALL__STATFS = 43,
  RV_SYSCALL__FSTATFS = 44,
  RV_SYSCALL__TRUNCATE = 45,
  RV_SYSCALL__FTRUNCATE = 46,
  RV_SYSCALL__FALLOCATE = 47,
  RV_SYSCALL__FACCESSAT = 48,
  RV_SYSCALL__CHDIR = 49,
  RV_SYSCALL__FCHDIR = 50,
  RV_SYSCALL__CHROOT = 51,
  RV_SYSCALL__FCHMOD = 52,
  RV_SYSCALL__FCHMODAT = 53,
  RV_SYSCALL__FCHOWNAT = 54,
  RV_SYSCALL__FCHOWN = 55,
  RV_SYSCALL__OPENAT = 56,
  RV_SYSCALL__CLOSE = 57,
  RV_SYSCALL__VHANGUP = 58,
  RV_SYSCALL__PIPE2 = 59,
  RV_SYSCALL__QUOTACTL = 60,
  RV_SYSCALL__GETDENTS64 = 61,
  RV_SYSCALL__LSEEK = 62,
  RV_SYSCALL__READ = 63,
  RV_SYSCALL__WRITE = 64,
  RV_SYSCALL__READV = 65,
  RV_SYSCALL__WRITEV = 66,
  RV_SYSCALL__PREAD64 = 67,
  RV_SYSCALL__PWRITE64 = 68,
  RV_SYSCALL__PREADV = 69,
  RV_SYSCALL__PWRITEV = 70,
  RV_SYSCALL__SENDFILE = 71,
  RV_SYSCALL__PSELECT6 = 72,
  RV_SYSCALL__PPOLL = 73,
  RV_SYSCALL__SIGNALFD4 = 74,
  RV_SYSCALL__VMSPLICE = 75,
  RV_SYSCALL__SPLICE = 76,
  RV_SYSCALL__TEE = 77,
  RV_SYSCALL__READLINKAT = 78,
  RV_SYSCALL__FSTATAT = 79,
  RV_SYSCALL__FSTAT = 80,
  RV_SYSCALL__SYNC = 81,
  RV_SYSCALL__FSYNC = 82,
  RV_SYSCALL__FDATASYNC = 83,
  RV_SYSCALL__SYNC_FILE_RANGE = 84,
  RV_SYSCALL__TIMERFD_CREATE = 85,
  RV_SYSCALL__TIMERFD_SETTIME = 86,
  RV_SYSCALL__TIMERFD_GETTIME = 87,
  RV_SYSCALL__UTIMENSAT = 88,
  RV_SYSCALL__ACCT = 89,
  RV_SYSCALL__CAPGET = 90,
  RV_SYSCALL__CAPSET = 91,
  RV_SYSCALL__PERSONALITY = 92,
  RV_SYSCALL__EXIT = 93,
  RV_SYSCALL__EXIT_GROUP = 94,
  RV_SYSCALL__WAITID = 95,
  RV_SYSCALL__SET_TID_ADDRESS = 96,
  RV_SYSCALL__UNSHARE = 97,
  RV_SYSCALL__FUTEX = 98,
  RV_SYSCALL__SET_ROBUST_LIST = 99,
  RV_SYSCALL__GET_ROBUST_LIST = 100,
  RV_SYSCALL__NANOSLEEP = 101,
  RV_SYSCALL__GETITIMER = 102,
  RV_SYSCALL__SETITIMER = 103,
  RV_SYSCALL__KEXEC_LOAD = 104,
  RV_SYSCALL__INIT_MODULE = 105,
  RV_SYSCALL__DELETE_MODULE = 106,
  RV_SYSCALL__TIMER_CREATE = 107,
  RV_SYSCALL__TIMER_GETTIME = 108,
  RV_SYSCALL__TIMER_GETOVERRUN = 109,
  RV_SYSCALL__TIMER_SETTIME = 110,
  RV_SYSCALL__TIMER_DELETE = 111,
  RV_SYSCALL__CLOCK_SETTIME = 112,
  RV_SYSCALL__CLOCK_GETTIME = 113,
  RV_SYSCALL__CLOCK_GETRES = 114,
  RV_SYSCALL__CLOCK_NANOSLEEP = 115,
  RV_SYSCALL__SYSLOG = 116,
  RV_SYSCALL__PTRACE = 117,
  RV_SYSCALL__SCHED_SETPARAM = 118,
  RV_SYSCALL__SCHED_SETSCHEDULER = 119,
  RV_SYSCALL__SCHED_GETSCHEDULER = 120,
  RV_SYSCALL__SCHED_GETPARAM = 121,
  RV_SYSCALL__SCHED_SETAFFINITY = 122,
  RV_SYSCALL__SCHED_GETAFFINITY = 123,
  RV_SYSCALL__SCHED_YIELD = 124,
  RV_SYSCALL__SCHED_GET_PRIORITY_MAX = 125,
  RV_SYSCALL__SCHED_GET_PRIORITY_MIN = 126,
  RV_SYSCALL__SCHED_RR_GET_INTERVAL = 127,
  RV_SYSCALL__RESTART_SYSCALL = 128,
  RV_SYSCALL__KILL = 129,
  RV_SYSCALL__TKILL = 130,
  RV_SYSCALL__TGKILL = 131,
  RV_SYSCALL__SIGALTSTACK = 132,
  RV_SYSCALL__RT_SIGSUSPEND = 133,
  RV_SYSCALL__RT_SIGACTION = 134,
  RV_SYSCALL__RT_SIGPROCMASK = 135,
  RV_SYSCALL__RT_SIGPENDING = 136,
  RV_SYSCALL__RT_SIGTIMEDWAIT = 137,
  RV_SYSCALL__RT_SIGQUEUEINFO = 138,
  RV_SYSCALL__RT_SIGRETURN = 139,
  RV_SYSCALL__SETPRIORITY = 140,
  RV_SYSCALL__GETPRIORITY = 141,
  RV_SYSCALL__REBOOT = 142,
  RV_SYSCALL__SETREGID = 143,
  RV_SYSCALL__SETGID = 144,
  RV_SYSCALL__SETREUID = 145,
  RV_SYSCALL__SETUID = 146,
  RV_SYSCALL__SETRESUID = 147,
  RV_SYSCALL__GETRESUID = 148,
  RV_SYSCALL__SETRESGID = 149,
  RV_SYSCALL__GETRESGID = 150,
  RV_SYSCALL__SETFSUID = 151,
  RV_SYSCALL__SETFSGID = 152,
  RV_SYSCALL__TIMES = 153,
  RV_SYSCALL__SETPGID = 154,
  RV_SYSCALL__GETPGID = 155,
  RV_SYSCALL__GETSID = 156,
  RV_SYSCALL__SETSID = 157,
  RV_SYSCALL__GETGROUPS = 158,
  RV_SYSCALL__SETGROUPS = 159,
  RV_SYSCALL__UNAME = 160,
  RV_SYSCALL__SETHOSTNAME = 161,
  RV_SYSCALL__SETDOMAINNAME = 162,
  RV_SYSCALL__GETRLIMIT = 163,
  RV_SYSCALL__SETRLIMIT = 164,
  RV_SYSCALL__GETRUSAGE = 165,
  RV_SYSCALL__UMASK = 166,
  RV_SYSCALL__PRCTL = 167,
  RV_SYSCALL__GETCPU = 168,
  RV_SYSCALL__GETTIMEOFDAY = 169,
  RV_SYSCALL__SETTIMEOFDAY = 170,
  RV_SYSCALL__ADJTIMEX = 171,
  RV_SYSCALL__GETPID = 172,
  RV_SYSCALL__GETPPID = 173,
  RV_SYSCALL__GETUID = 174,
  RV_SYSCALL__GETEUID = 175,
  RV_SYSCALL__GETGID = 176,
  RV_SYSCALL__GETEGID = 177,
  RV_SYSCALL__GETTID = 178,
  RV_SYSCALL__SYSINFO = 179,
  RV_SYSCALL__MQ_OPEN = 180,
  RV_SYSCALL__MQ_UNLINK = 181,
  RV_SYSCALL__MQ_TIMEDSEND = 182,
  RV_SYSCALL__MQ_TIMEDRECEIVE = 183,
  RV_SYSCALL__MQ_NOTIFY = 184,
  RV_SYSCALL__MQ_GETSETATTR = 185,
  RV_SYSCALL__MSGGET = 186,
  RV_SYSCALL__MSGCTL = 187,
  RV_SYSCALL__MSGRCV = 188,
  RV_SYSCALL__MSGSND = 189,
  RV_SYSCALL__SEMGET = 190,
  RV_SYSCALL__SEMCTL = 191,
  RV_SYSCALL__SEMTIMEDOP = 192,
  RV_SYSCALL__SEMOP = 193,
  RV_SYSCALL__SHMGET = 194,
  RV_SYSCALL__SHMCTL = 195,
  RV_SYSCALL__SHMAT = 196,
  RV_SYSCALL__SHMDT = 197,
  RV_SYSCALL__SOCKET = 198,
  RV_SYSCALL__SOCKETPAIR = 199,
  RV_SYSCALL__BIND = 200,
  RV_SYSCALL__LISTEN = 201,
  RV_SYSCALL__ACCEPT = 202,
  RV_SYSCALL__CONNECT = 203,
  RV_SYSCALL__GETSOCKNAME = 204,
  RV_SYSCALL__GETPEERNAME = 205,
  RV_SYSCALL__SENDTO = 206,
  RV_SYSCALL__RECVFROM = 207,
  RV_SYSCALL__SETSOCKOPT = 208,
  RV_SYSCALL__GETSOCKOPT = 209,
  RV_SYSCALL__SHUTDOWN = 210,
  RV_SYSCALL__SENDMSG = 211,
  RV_SYSCALL__RECVMSG = 212,
  RV_SYSCALL__READAHEAD = 213,
  RV_SYSCALL__BRK = 214,
  RV_SYSCALL__MUNMAP = 215,
  RV_SYSCALL__MREMAP = 216,
  RV_SYSCALL__ADD_KEY = 217,
  RV_SYSCALL__REQUEST_KEY = 218,
  RV_SYSCALL__KEYCTL = 219,
  RV_SYSCALL__CLONE = 220,
  RV_SYSCALL__EXECVE = 221,
  RV_SYSCALL__MMAP = 222,
  RV_SYSCALL__FADVISE64 = 223,
  RV_SYSCALL__SWAPON = 224,
  RV_SYSCALL__SWAPOFF = 225,
  RV_SYSCALL__MPROTECT = 226,
  RV_SYSCALL__MSYNC = 227,
  RV_SYSCALL__MLOCK = 228,
  RV_SYSCALL__MUNLOCK = 229,
  RV_SYSCALL__MLOCKALL = 230,
  RV_SYSCALL__MUNLOCKALL = 231,
  RV_SYSCALL__MINCORE = 232,
  RV_SYSCALL__MADVISE = 233,
  RV_SYSCALL__REMAP_FILE_PAGES = 234,
  RV_SYSCALL__MBIND = 235,
  RV_SYSCALL__GET_MEMPOLICY = 236,
  RV_SYSCALL__SET_MEMPOLICY = 237,
  RV_SYSCALL__MIGRATE_PAGES = 238,
  RV_SYSCALL__MOVE_PAGES = 239,
  RV_SYSCALL__RT_TGSIGQUEUEINFO = 240,
  RV_SYSCALL__PERF_EVENT_OPEN = 241,
};