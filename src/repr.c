#include "platform.h"
#include "syscall.h"
#include "emu.h"

#define INSN_MAP_ENTRY(insn) [RV_INSN__##insn] = #insn
#define SYSC_MAP_ENTRY(sysc) [RV_SYSCALL__##sysc] = #sysc
#define INSN_MAP_ENTRY_S(insn, repr) [RV_INSN__##insn] = repr
#define SYSC_MAP_ENTRY_S(insn, repr) [RV_SYSCALL__##sysc] = repr

const char* const repr_reg_abi_map[] = {
  "zero",
  "ra",
  "sp",
  "gp",
  "tp",
  "t0", "t1", "t2",
  "s0", "s1",
  "a0", "a1", "a2", "a3", "a4", "a5", "a6", "a7",
  "s2", "s3", "s4", "s5", "s6", "s7", "s8", "s9", "s10", "s11",
  "t3", "t4", "t5", "t6"
};

#if RV32_HAS(EXT_FD)
const char* const repr_freg_abi_map[] = {
  "ft0", "ft1", "ft2", "ft3", "ft4", "ft5", "ft6", "ft7",
  "fs0", "fs1",
  "fa0", "fa1", "fa2", "fa3", "fa4", "fa5", "fa6", "fa7",
  "fs2", "fs3", "fs4", "fs5", "fs6", "fs7", "fs8", "fs9", "fs10", "fs11",
  "ft8", "ft9", "ft10", "ft11"
};
#endif

const char* const repr_insn_map[] = {
  INSN_MAP_ENTRY(INVALID),
  INSN_MAP_ENTRY(LUI),
  INSN_MAP_ENTRY(AUIPC),
  INSN_MAP_ENTRY(JAL),
  INSN_MAP_ENTRY(JALR),
  INSN_MAP_ENTRY(BEQ),
  INSN_MAP_ENTRY(BNE),
  INSN_MAP_ENTRY(BLT),
  INSN_MAP_ENTRY(BGE),
  INSN_MAP_ENTRY(BLTU),
  INSN_MAP_ENTRY(BGEU),
  INSN_MAP_ENTRY(LB),
  INSN_MAP_ENTRY(LH),
  INSN_MAP_ENTRY(LW),
  INSN_MAP_ENTRY(LBU),
  INSN_MAP_ENTRY(LHU),
  INSN_MAP_ENTRY(SB),
  INSN_MAP_ENTRY(SH),
  INSN_MAP_ENTRY(SW),
  INSN_MAP_ENTRY(ADDI),
  INSN_MAP_ENTRY(SLTI),
  INSN_MAP_ENTRY(SLTIU),
  INSN_MAP_ENTRY(XORI),
  INSN_MAP_ENTRY(ORI),
  INSN_MAP_ENTRY(ANDI),
  INSN_MAP_ENTRY(SLLI),
  INSN_MAP_ENTRY(SRLI),
  INSN_MAP_ENTRY(SRAI),
  INSN_MAP_ENTRY(ADD),
  INSN_MAP_ENTRY(SUB),
  INSN_MAP_ENTRY(SLL),
  INSN_MAP_ENTRY(SLT),
  INSN_MAP_ENTRY(SLTU),
  INSN_MAP_ENTRY(XOR),
  INSN_MAP_ENTRY(SRL),
  INSN_MAP_ENTRY(SRA),
  INSN_MAP_ENTRY(OR),
  INSN_MAP_ENTRY(AND),
  INSN_MAP_ENTRY(FENCE),
  INSN_MAP_ENTRY(FENCE_I),
  INSN_MAP_ENTRY(ECALL),
  INSN_MAP_ENTRY(EBREAK),
  INSN_MAP_ENTRY(CSRRW),
  INSN_MAP_ENTRY(CSRRS),
  INSN_MAP_ENTRY(CSRRC),
  INSN_MAP_ENTRY(CSRRWI),
  INSN_MAP_ENTRY(CSRRSI),
  INSN_MAP_ENTRY(CSRRCI),
#if RV32_HAS(EXT_M)
  INSN_MAP_ENTRY(MUL),
  INSN_MAP_ENTRY(MULH),
  INSN_MAP_ENTRY(MULHSU),
  INSN_MAP_ENTRY(MULHU),
  INSN_MAP_ENTRY(DIV),
  INSN_MAP_ENTRY(DIVU),
  INSN_MAP_ENTRY(REM),
  INSN_MAP_ENTRY(REMU),
#endif
#if RV32_HAS(EXT_FD)
  INSN_MAP_ENTRY_S(FLx, "FL.x"),
  INSN_MAP_ENTRY_S(FSx, "FS.x"),
  INSN_MAP_ENTRY_S(FMADDx, "FMADD.x"),
  INSN_MAP_ENTRY_S(FMSUBx, "FMSUB.x"),
  INSN_MAP_ENTRY_S(FNMADDx, "FNMADD.x"),
  INSN_MAP_ENTRY_S(FNMSUBx, "FNMSUB.x"),
  INSN_MAP_ENTRY_S(FADDx, "FADD.x"),
  INSN_MAP_ENTRY_S(FSUBx, "FSUB.x"),
  INSN_MAP_ENTRY_S(FMULx, "FMUL.x"),
  INSN_MAP_ENTRY_S(FDIVx, "FDIV.x"),
  INSN_MAP_ENTRY_S(FSQRTx, "FSQRT.x"),
  INSN_MAP_ENTRY_S(FSGNJx, "FSGNJ.x"),
  INSN_MAP_ENTRY_S(FSGNJNx, "FSGNJN.x"),
  INSN_MAP_ENTRY_S(FSGNJXx, "FSGNJX.x"),
  INSN_MAP_ENTRY_S(FMINx, "FMIN.x"),
  INSN_MAP_ENTRY_S(FMAXx, "FMAX.x"),
  INSN_MAP_ENTRY_S(FEQx, "FEQ.x"),
  INSN_MAP_ENTRY_S(FLTx, "FLT.x"),
  INSN_MAP_ENTRY_S(FLEx, "FLE.x"),
  INSN_MAP_ENTRY_S(FCLASSx, "FCLASS.x"),
  INSN_MAP_ENTRY_S(FCVT_x_W, "FCVT.x.W"),
  INSN_MAP_ENTRY_S(FCVT_x_WU, "FCVT.x.WU"),
  INSN_MAP_ENTRY_S(FCVT_W_x, "FCVT.W.x"),
  INSN_MAP_ENTRY_S(FCVT_WU_x, "FCVT.WU.x"),
  INSN_MAP_ENTRY_S(FMV_X_W, "FMV.X.W"),
  INSN_MAP_ENTRY_S(FMV_W_X, "FMV.W.X"),
  INSN_MAP_ENTRY_S(FCVT_S_D, "FCVT.S.D"),
  INSN_MAP_ENTRY_S(FCVT_D_S, "FCVT.D.S"),
#endif
#if RV32_HAS(EXT_C)
  INSN_MAP_ENTRY_S(C_NOP, "c.nop"),
  INSN_MAP_ENTRY_S(C_ADDI, "c.addi"),
  INSN_MAP_ENTRY_S(C_JAL, "c.jal"),
  INSN_MAP_ENTRY_S(C_LI, "c.li"),
  INSN_MAP_ENTRY_S(C_ADDI16SP, "c.addi16sp"),
  INSN_MAP_ENTRY_S(C_LUI, "c.lui"),
  INSN_MAP_ENTRY_S(C_SRLI, "c.srli"),
  INSN_MAP_ENTRY_S(C_SRAI, "c.srai"),
  INSN_MAP_ENTRY_S(C_ANDI, "c.andi"),
  INSN_MAP_ENTRY_S(C_SUB, "c.sub"),
  INSN_MAP_ENTRY_S(C_XOR, "c.xor"),
  INSN_MAP_ENTRY_S(C_OR, "c.or"),
  INSN_MAP_ENTRY_S(C_AND, "c.and"),
  INSN_MAP_ENTRY_S(C_J, "c.j"),
  INSN_MAP_ENTRY_S(C_BEQZ, "c.beqz"),
  INSN_MAP_ENTRY_S(C_BNEZ, "c.bnez"),
  INSN_MAP_ENTRY_S(C_ADDI4SPN, "c.addi4spn"),
  INSN_MAP_ENTRY_S(C_FLD, "c.fld"),
  INSN_MAP_ENTRY_S(C_LW, "c.lw"),
  INSN_MAP_ENTRY_S(C_FLW, "c.flw"),
  INSN_MAP_ENTRY_S(C_FSD, "c.fsd"),
  INSN_MAP_ENTRY_S(C_SW, "c.sw"),
  INSN_MAP_ENTRY_S(C_FSW, "c.fsw"),
  INSN_MAP_ENTRY_S(C_SLLI, "c.slli"),
  INSN_MAP_ENTRY_S(C_SLLI64, "c.slli64"),
  INSN_MAP_ENTRY_S(C_FLDSP, "c.fldsp"),
  INSN_MAP_ENTRY_S(C_LWSP, "c.lwsp"),
  INSN_MAP_ENTRY_S(C_FLWSP, "c.flwsp"),
  INSN_MAP_ENTRY_S(C_JR, "c.jr"),
  INSN_MAP_ENTRY_S(C_MV, "c.mv"),
  INSN_MAP_ENTRY_S(C_EBREAK, "c.ebreak"),
  INSN_MAP_ENTRY_S(C_JALR, "c.jalr"),
  INSN_MAP_ENTRY_S(C_ADD, "c.add"),
  INSN_MAP_ENTRY_S(C_FSDSP, "c.fsdsp"),
  INSN_MAP_ENTRY_S(C_SWSP, "c.swsp"),
  INSN_MAP_ENTRY_S(C_FSWSP, "c.fswsp"),
#endif
};

const char* const repr_syscall_map[] = {
  SYSC_MAP_ENTRY(IO_SETUP),
  SYSC_MAP_ENTRY(IO_DESTROY),
  SYSC_MAP_ENTRY(IO_SUBMIT),
  SYSC_MAP_ENTRY(IO_CANCEL),
  SYSC_MAP_ENTRY(IO_GETEVENTS),
  SYSC_MAP_ENTRY(SETXATTR),
  SYSC_MAP_ENTRY(LSETXATTR),
  SYSC_MAP_ENTRY(FSETXATTR),
  SYSC_MAP_ENTRY(GETXATTR),
  SYSC_MAP_ENTRY(LGETXATTR),
  SYSC_MAP_ENTRY(FGETXATTR),
  SYSC_MAP_ENTRY(LISTXATTR),
  SYSC_MAP_ENTRY(LLISTXATTR),
  SYSC_MAP_ENTRY(FLISTXATTR),
  SYSC_MAP_ENTRY(REMOVEXATTR),
  SYSC_MAP_ENTRY(LREMOVEXATTR),
  SYSC_MAP_ENTRY(FREMOVEXATTR),
  SYSC_MAP_ENTRY(GETCWD),
  SYSC_MAP_ENTRY(LOOKUP_DCOOKIE),
  SYSC_MAP_ENTRY(EVENTFD2),
  SYSC_MAP_ENTRY(EPOLL_CREATE1),
  SYSC_MAP_ENTRY(EPOLL_CTL),
  SYSC_MAP_ENTRY(EPOLL_PWAIT),
  SYSC_MAP_ENTRY(DUP),
  SYSC_MAP_ENTRY(DUP3),
  SYSC_MAP_ENTRY(FCNTL),
  SYSC_MAP_ENTRY(INOTIFY_INIT1),
  SYSC_MAP_ENTRY(INOTIFY_ADD_WATCH),
  SYSC_MAP_ENTRY(INOTIFY_RM_WATCH),
  SYSC_MAP_ENTRY(IOCTL),
  SYSC_MAP_ENTRY(IOPRIO_SET),
  SYSC_MAP_ENTRY(IOPRIO_GET),
  SYSC_MAP_ENTRY(FLOCK),
  SYSC_MAP_ENTRY(MKNODAT),
  SYSC_MAP_ENTRY(MKDIRAT),
  SYSC_MAP_ENTRY(UNLINKAT),
  SYSC_MAP_ENTRY(SYMLINKAT),
  SYSC_MAP_ENTRY(LINKAT),
  SYSC_MAP_ENTRY(RENAMEAT),
  SYSC_MAP_ENTRY(UMOUNT2),
  SYSC_MAP_ENTRY(MOUNT),
  SYSC_MAP_ENTRY(PIVOT_ROOT),
  SYSC_MAP_ENTRY(NFSSERVCTL),
  SYSC_MAP_ENTRY(STATFS),
  SYSC_MAP_ENTRY(FSTATFS),
  SYSC_MAP_ENTRY(TRUNCATE),
  SYSC_MAP_ENTRY(FTRUNCATE),
  SYSC_MAP_ENTRY(FALLOCATE),
  SYSC_MAP_ENTRY(FACCESSAT),
  SYSC_MAP_ENTRY(CHDIR),
  SYSC_MAP_ENTRY(FCHDIR),
  SYSC_MAP_ENTRY(CHROOT),
  SYSC_MAP_ENTRY(FCHMOD),
  SYSC_MAP_ENTRY(FCHMODAT),
  SYSC_MAP_ENTRY(FCHOWNAT),
  SYSC_MAP_ENTRY(FCHOWN),
  SYSC_MAP_ENTRY(OPENAT),
  SYSC_MAP_ENTRY(CLOSE),
  SYSC_MAP_ENTRY(VHANGUP),
  SYSC_MAP_ENTRY(PIPE2),
  SYSC_MAP_ENTRY(QUOTACTL),
  SYSC_MAP_ENTRY(GETDENTS64),
  SYSC_MAP_ENTRY(LSEEK),
  SYSC_MAP_ENTRY(READ),
  SYSC_MAP_ENTRY(WRITE),
  SYSC_MAP_ENTRY(READV),
  SYSC_MAP_ENTRY(WRITEV),
  SYSC_MAP_ENTRY(PREAD64),
  SYSC_MAP_ENTRY(PWRITE64),
  SYSC_MAP_ENTRY(PREADV),
  SYSC_MAP_ENTRY(PWRITEV),
  SYSC_MAP_ENTRY(SENDFILE),
  SYSC_MAP_ENTRY(PSELECT6),
  SYSC_MAP_ENTRY(PPOLL),
  SYSC_MAP_ENTRY(SIGNALFD4),
  SYSC_MAP_ENTRY(VMSPLICE),
  SYSC_MAP_ENTRY(SPLICE),
  SYSC_MAP_ENTRY(TEE),
  SYSC_MAP_ENTRY(READLINKAT),
  SYSC_MAP_ENTRY(FSTATAT),
  SYSC_MAP_ENTRY(FSTAT),
  SYSC_MAP_ENTRY(SYNC),
  SYSC_MAP_ENTRY(FSYNC),
  SYSC_MAP_ENTRY(FDATASYNC),
  SYSC_MAP_ENTRY(SYNC_FILE_RANGE),
  SYSC_MAP_ENTRY(TIMERFD_CREATE),
  SYSC_MAP_ENTRY(TIMERFD_SETTIME),
  SYSC_MAP_ENTRY(TIMERFD_GETTIME),
  SYSC_MAP_ENTRY(UTIMENSAT),
  SYSC_MAP_ENTRY(ACCT),
  SYSC_MAP_ENTRY(CAPGET),
  SYSC_MAP_ENTRY(CAPSET),
  SYSC_MAP_ENTRY(PERSONALITY),
  SYSC_MAP_ENTRY(EXIT),
  SYSC_MAP_ENTRY(EXIT_GROUP),
  SYSC_MAP_ENTRY(WAITID),
  SYSC_MAP_ENTRY(SET_TID_ADDRESS),
  SYSC_MAP_ENTRY(UNSHARE),
  SYSC_MAP_ENTRY(FUTEX),
  SYSC_MAP_ENTRY(SET_ROBUST_LIST),
  SYSC_MAP_ENTRY(GET_ROBUST_LIST),
  SYSC_MAP_ENTRY(NANOSLEEP),
  SYSC_MAP_ENTRY(GETITIMER),
  SYSC_MAP_ENTRY(SETITIMER),
  SYSC_MAP_ENTRY(KEXEC_LOAD),
  SYSC_MAP_ENTRY(INIT_MODULE),
  SYSC_MAP_ENTRY(DELETE_MODULE),
  SYSC_MAP_ENTRY(TIMER_CREATE),
  SYSC_MAP_ENTRY(TIMER_GETTIME),
  SYSC_MAP_ENTRY(TIMER_GETOVERRUN),
  SYSC_MAP_ENTRY(TIMER_SETTIME),
  SYSC_MAP_ENTRY(TIMER_DELETE),
  SYSC_MAP_ENTRY(CLOCK_SETTIME),
  SYSC_MAP_ENTRY(CLOCK_GETTIME),
  SYSC_MAP_ENTRY(CLOCK_GETRES),
  SYSC_MAP_ENTRY(CLOCK_NANOSLEEP),
  SYSC_MAP_ENTRY(SYSLOG),
  SYSC_MAP_ENTRY(PTRACE),
  SYSC_MAP_ENTRY(SCHED_SETPARAM),
  SYSC_MAP_ENTRY(SCHED_SETSCHEDULER),
  SYSC_MAP_ENTRY(SCHED_GETSCHEDULER),
  SYSC_MAP_ENTRY(SCHED_GETPARAM),
  SYSC_MAP_ENTRY(SCHED_SETAFFINITY),
  SYSC_MAP_ENTRY(SCHED_GETAFFINITY),
  SYSC_MAP_ENTRY(SCHED_YIELD),
  SYSC_MAP_ENTRY(SCHED_GET_PRIORITY_MAX),
  SYSC_MAP_ENTRY(SCHED_GET_PRIORITY_MIN),
  SYSC_MAP_ENTRY(SCHED_RR_GET_INTERVAL),
  SYSC_MAP_ENTRY(RESTART_SYSCALL),
  SYSC_MAP_ENTRY(KILL),
  SYSC_MAP_ENTRY(TKILL),
  SYSC_MAP_ENTRY(TGKILL),
  SYSC_MAP_ENTRY(SIGALTSTACK),
  SYSC_MAP_ENTRY(RT_SIGSUSPEND),
  SYSC_MAP_ENTRY(RT_SIGACTION),
  SYSC_MAP_ENTRY(RT_SIGPROCMASK),
  SYSC_MAP_ENTRY(RT_SIGPENDING),
  SYSC_MAP_ENTRY(RT_SIGTIMEDWAIT),
  SYSC_MAP_ENTRY(RT_SIGQUEUEINFO),
  SYSC_MAP_ENTRY(RT_SIGRETURN),
  SYSC_MAP_ENTRY(SETPRIORITY),
  SYSC_MAP_ENTRY(GETPRIORITY),
  SYSC_MAP_ENTRY(REBOOT),
  SYSC_MAP_ENTRY(SETREGID),
  SYSC_MAP_ENTRY(SETGID),
  SYSC_MAP_ENTRY(SETREUID),
  SYSC_MAP_ENTRY(SETUID),
  SYSC_MAP_ENTRY(SETRESUID),
  SYSC_MAP_ENTRY(GETRESUID),
  SYSC_MAP_ENTRY(SETRESGID),
  SYSC_MAP_ENTRY(GETRESGID),
  SYSC_MAP_ENTRY(SETFSUID),
  SYSC_MAP_ENTRY(SETFSGID),
  SYSC_MAP_ENTRY(TIMES),
  SYSC_MAP_ENTRY(SETPGID),
  SYSC_MAP_ENTRY(GETPGID),
  SYSC_MAP_ENTRY(GETSID),
  SYSC_MAP_ENTRY(SETSID),
  SYSC_MAP_ENTRY(GETGROUPS),
  SYSC_MAP_ENTRY(SETGROUPS),
  SYSC_MAP_ENTRY(UNAME),
  SYSC_MAP_ENTRY(SETHOSTNAME),
  SYSC_MAP_ENTRY(SETDOMAINNAME),
  SYSC_MAP_ENTRY(GETRLIMIT),
  SYSC_MAP_ENTRY(SETRLIMIT),
  SYSC_MAP_ENTRY(GETRUSAGE),
  SYSC_MAP_ENTRY(UMASK),
  SYSC_MAP_ENTRY(PRCTL),
  SYSC_MAP_ENTRY(GETCPU),
  SYSC_MAP_ENTRY(GETTIMEOFDAY),
  SYSC_MAP_ENTRY(SETTIMEOFDAY),
  SYSC_MAP_ENTRY(ADJTIMEX),
  SYSC_MAP_ENTRY(GETPID),
  SYSC_MAP_ENTRY(GETPPID),
  SYSC_MAP_ENTRY(GETUID),
  SYSC_MAP_ENTRY(GETEUID),
  SYSC_MAP_ENTRY(GETGID),
  SYSC_MAP_ENTRY(GETEGID),
  SYSC_MAP_ENTRY(GETTID),
  SYSC_MAP_ENTRY(SYSINFO),
  SYSC_MAP_ENTRY(MQ_OPEN),
  SYSC_MAP_ENTRY(MQ_UNLINK),
  SYSC_MAP_ENTRY(MQ_TIMEDSEND),
  SYSC_MAP_ENTRY(MQ_TIMEDRECEIVE),
  SYSC_MAP_ENTRY(MQ_NOTIFY),
  SYSC_MAP_ENTRY(MQ_GETSETATTR),
  SYSC_MAP_ENTRY(MSGGET),
  SYSC_MAP_ENTRY(MSGCTL),
  SYSC_MAP_ENTRY(MSGRCV),
  SYSC_MAP_ENTRY(MSGSND),
  SYSC_MAP_ENTRY(SEMGET),
  SYSC_MAP_ENTRY(SEMCTL),
  SYSC_MAP_ENTRY(SEMTIMEDOP),
  SYSC_MAP_ENTRY(SEMOP),
  SYSC_MAP_ENTRY(SHMGET),
  SYSC_MAP_ENTRY(SHMCTL),
  SYSC_MAP_ENTRY(SHMAT),
  SYSC_MAP_ENTRY(SHMDT),
  SYSC_MAP_ENTRY(SOCKET),
  SYSC_MAP_ENTRY(SOCKETPAIR),
  SYSC_MAP_ENTRY(BIND),
  SYSC_MAP_ENTRY(LISTEN),
  SYSC_MAP_ENTRY(ACCEPT),
  SYSC_MAP_ENTRY(CONNECT),
  SYSC_MAP_ENTRY(GETSOCKNAME),
  SYSC_MAP_ENTRY(GETPEERNAME),
  SYSC_MAP_ENTRY(SENDTO),
  SYSC_MAP_ENTRY(RECVFROM),
  SYSC_MAP_ENTRY(SETSOCKOPT),
  SYSC_MAP_ENTRY(GETSOCKOPT),
  SYSC_MAP_ENTRY(SHUTDOWN),
  SYSC_MAP_ENTRY(SENDMSG),
  SYSC_MAP_ENTRY(RECVMSG),
  SYSC_MAP_ENTRY(READAHEAD),
  SYSC_MAP_ENTRY(BRK),
  SYSC_MAP_ENTRY(MUNMAP),
  SYSC_MAP_ENTRY(MREMAP),
  SYSC_MAP_ENTRY(ADD_KEY),
  SYSC_MAP_ENTRY(REQUEST_KEY),
  SYSC_MAP_ENTRY(KEYCTL),
  SYSC_MAP_ENTRY(CLONE),
  SYSC_MAP_ENTRY(EXECVE),
  SYSC_MAP_ENTRY(MMAP),
  SYSC_MAP_ENTRY(FADVISE64),
  SYSC_MAP_ENTRY(SWAPON),
  SYSC_MAP_ENTRY(SWAPOFF),
  SYSC_MAP_ENTRY(MPROTECT),
  SYSC_MAP_ENTRY(MSYNC),
  SYSC_MAP_ENTRY(MLOCK),
  SYSC_MAP_ENTRY(MUNLOCK),
  SYSC_MAP_ENTRY(MLOCKALL),
  SYSC_MAP_ENTRY(MUNLOCKALL),
  SYSC_MAP_ENTRY(MINCORE),
  SYSC_MAP_ENTRY(MADVISE),
  SYSC_MAP_ENTRY(REMAP_FILE_PAGES),
  SYSC_MAP_ENTRY(MBIND),
  SYSC_MAP_ENTRY(GET_MEMPOLICY),
  SYSC_MAP_ENTRY(SET_MEMPOLICY),
  SYSC_MAP_ENTRY(MIGRATE_PAGES),
  SYSC_MAP_ENTRY(MOVE_PAGES),
  SYSC_MAP_ENTRY(RT_TGSIGQUEUEINFO),
  SYSC_MAP_ENTRY(PERF_EVENT_OPEN),
};

#undef INSN_MAP_ENTRY
#undef SYSC_MAP_ENTRY
#undef INSN_MAP_ENTRY_S
#undef SYSC_MAP_ENTRY_S